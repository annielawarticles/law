<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>法律專欄｜安心法律網</title>
  <style>
    :root{
      --ink:#2f3b55;
      --ink-2:#3e4a68;
      --bg:#fff9f0;
      --card:#ffffff;
      --muted:#eef3f8;
      --chip:#e6edf6;
      --accent:#d4af37; /* 金色 */
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:"Microsoft JhengHei","Noto Sans TC",system-ui;
      background:var(--bg);
      color:#333;
    }

    header{
      background:var(--ink);
      color:#fff;
      text-align:center;
      padding:1.5rem 1rem;
      position:relative;
    }
    header h1{ margin:0; font-size:2rem; font-weight:800; }
    header p{ margin:.25rem 0 0; opacity:.9; }

    /* 右上角金色預約按鈕（直接連到 Google 表單） */
    .consult-btn{
      position:absolute; right:1rem; top:1rem;
      background:var(--accent); color:#fff;
      padding:.55rem 1rem; border-radius:999px;
      text-decoration:none; font-weight:800; font-size:.95rem;
      box-shadow:0 2px 6px rgba(0,0,0,.15); transition:all .2s;
    }
    .consult-btn:hover{ filter:brightness(1.05); transform:translateY(-1px); }

    nav{
      background:var(--ink-2); text-align:center; padding:.75rem 1rem;
      position:sticky; top:0; z-index:10;
    }
    nav a{ color:#fff; text-decoration:none; font-weight:700; margin:0 .9rem; }
    nav a:hover{ opacity:.85; }

    .wrap{ max-width:1040px; margin:1.25rem auto 2rem; padding:0 1rem; }

    /* 工具列：搜尋 + chips */
    .toolbar{ display:flex; flex-wrap:wrap; gap:.75rem; align-items:center; margin-bottom:1rem; }
    .search{ flex:1 1 220px; display:flex; }
    .search input{
      width:100%; padding:.65rem .9rem; border-radius:10px;
      border:1px solid #d4dbe6; outline:none; background:#fff;
    }
    .chips{ display:flex; flex-wrap:wrap; gap:.5rem; }
    .chip{
      background:var(--chip); color:#223; border:1px solid #cfe0f4;
      padding:.4rem .7rem; border-radius:999px; cursor:pointer;
      font-size:.92rem; font-weight:700;
    }
    .chip[aria-pressed="true"]{ background:#2f3b55; color:#fff; border-color:#2f3b55; }

    /* 文章卡 */
    .grid{ display:grid; grid-template-columns:1fr; gap:1rem; }
    @media (min-width:680px){ .grid{ grid-template-columns:1fr 1fr; } }
    @media (min-width:1040px){ .grid{ grid-template-columns:1fr 1fr 1fr; } }

    .card{
      background:var(--card); border-radius:14px; overflow:hidden;
      box-shadow:0 2px 10px rgba(0,0,0,.06); display:flex; flex-direction:column;
    }
    .thumb{
      aspect-ratio:16/9; background:linear-gradient(135deg,#cdd9ea,#e9f0fb);
      display:flex; align-items:center; justify-content:center;
      font-weight:800; letter-spacing:.02em; color:#2f3b55;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .body{ padding:1rem 1rem 1.1rem; }
    .meta{
      font-size:.85rem; color:#445; opacity:.8; display:flex; gap:.5rem;
      align-items:center; margin-bottom:.35rem; flex-wrap:wrap;
    }
    .meta .tag{ background:#eef3ff; border:1px solid #d9e5ff; color:#2b3f77;
      border-radius:6px; padding:.12rem .4rem; font-weight:700; }
    .title{ font-weight:900; color:#1d2b3e; line-height:1.35; margin:.2rem 0 .55rem; font-size:1.03rem; }
    .excerpt{ margin:0 0 .75rem; color:#2a2a2a; }
    .read{ margin-top:auto; }
    .btn{
      display:inline-flex; align-items:center; gap:.45rem;
      background:#2f3b55; color:#fff; text-decoration:none;
      padding:.5rem .8rem; border-radius:10px; font-weight:800;
    }
    .btn:hover{ filter:brightness(.95); }

    footer{ background:var(--ink); color:#fff; text-align:center; padding:1rem; margin-top:2rem; }
  </style>
</head>
<body>
  <header>
    <h1>安心法律網</h1>
    <p>分享法律觀點，讓你了解法律的世界</p>
    <!-- 直接連到 Google 表單（新分頁） -->
    <a
      href="https://docs.google.com/forms/d/1iksNneNNuuFD6ZmsDJexKtz06JpAChbV_4Ko8AkWmfA/viewform"
      class="consult-btn" target="_blank" rel="noopener noreferrer"
    >預約諮詢</a>
  </header>

  <nav>
    <a href="../index.html">首頁</a>
    <a href="./index.html" aria-current="page">法律專欄</a>
    <a href="../cases/index.html">成功案例</a>
    <a href="../consult.html">開始諮詢</a>
  </nav>

  <main class="wrap">
    <div class="toolbar">
      <div class="search">
        <input id="q" type="search" placeholder="搜尋文章關鍵字…（例如：監護、漏水、存證信函）" />
      </div>
      <div class="chips" id="chips"></div>
    </div>

    <section id="list" class="grid" aria-live="polite"></section>
  </main>

  <footer>
    <p>© <span id="y"></span> 安心法律網</p>
  </footer>

  <script>
/* ===== 圖片路徑與預設圖 ===== */
// /articles/ 下面要用 ../images/，否則用 images/
const IMG_BASE = /\/(articles|cases)\//.test(location.pathname) ? '../images/' : 'images/';
const DEFAULT_FAMILY = IMG_BASE + 'family.png'; // 婚姻/親子
const DEFAULT_HOUSE  = IMG_BASE + 'house.png';  // 公寓大廈/不動產/漏水等
const DEFAULT_OFFICE = IMG_BASE + 'office.png'; // 民事法律

/* ===== 文章資料 ===== */
const ARTICLES = [
  { title:"如何離婚？離婚流程及必知權益？", url:"article1.html", date:"2025-04-21", tags:["婚姻相關"], excerpt:"離婚程序可分協議、調解與裁判三種；快速掌握流程與文件要點。", img:null },
  { title:"監護權爭奪戰：對方拒絕讓你看孩子，如何迅速行動捍衛權利？", url:"article2.html", date:"2025-04-21", tags:["婚姻相關"], excerpt:"面對監護與探視權糾紛，整理法院考量重點與臨時處分策略。", img:null },
  { title:"收到存證信函怎麼辦？", url:"article3.html", date:"2025-04-21", tags:["民事法律"], excerpt:"拆解存證信函的效力與回應步驟，避免踩雷。", img:null },
  { title:"如何斷絕親子關係，法律跟你想的不一樣", url:"article4.html", date:"2025-04-21", tags:["婚姻相關"], excerpt:"從民法觀點澄清『斷絕親子關係』的迷思與實務。", img:null },
  { title:"樓上鄰居漏水惱人，法律應對策略大公開", url:"article5.html", date:"2025-04-21", tags:["公寓大廈","民事法律"], excerpt:"從報修到訴訟，完整教學漏水糾紛的蒐證與求償流程。", img:null },
];

/* ===== 分類 chips ===== */
const TAGS = ["全部","婚姻相關","財產分配","遺囑繼承","不動產","公寓大廈","證據蒐證","車禍相關","民事法律","刑事法律"];

/* ===== DOM 快取 ===== */
const $ = (s,el=document)=>el.querySelector(s);
const listEl = $('#list');
const qEl = $('#q');
const chipsEl = $('#chips');

/* ===== 狀態 ===== */
const qs = new URLSearchParams(location.search);
let activeTag = qs.get('tag') || '全部';

/* ===== UI ===== */
function renderChips(){
  chipsEl.innerHTML = '';
  TAGS.forEach(tag=>{
    const b = document.createElement('button');
    b.className = 'chip';
    b.type = 'button';
    b.textContent = tag;
    b.setAttribute('aria-pressed', String(tag===activeTag));
    b.addEventListener('click',()=>{
      activeTag = tag;
      renderList();
      history.replaceState(null,'', tag==='全部' ? location.pathname : `?tag=${encodeURIComponent(tag)}`);
    });
    chipsEl.appendChild(b);
  });
}

function formatDate(iso){
  const d = new Date(iso);
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

/* ===== 自動配圖規則（優先：a.img → 家事 → 房屋 → 民事） ===== */
function pickThumb(a){
  if (a.img) return a.img;

  const tags = (a.tags || []).join(',');
  const text = [a.title, a.excerpt].filter(Boolean).join('、');

  const isFamily =
    /婚姻相關/.test(tags) || /監護|親子|扶養|探視/.test(text);

  const isHouse =
    /公寓大廈|不動產/.test(tags) || /漏水|管委會|區分所有|租賃|房屋|住戶/.test(text);

  const isCivil =
    /民事法律/.test(tags) || /民事|存證信函|債務|契約/.test(text);

  if (isFamily) return DEFAULT_FAMILY;
  if (isHouse)  return DEFAULT_HOUSE;
  if (isCivil)  return DEFAULT_OFFICE;
  return null;
}

/* ===== 卡片模板 ===== */
function template(a){
  const tag = a.tags?.[0] || '';
  const img = pickThumb(a);
  return `
    <article class="card">
      <div class="thumb">
        ${img ? `<img src="${img}" alt="文章封面">` : `${tag || '法律專欄'}`}
      </div>
      <div class="body">
        <div class="meta"><span>${formatDate(a.date)}</span>${tag?`<span class="tag">${tag}</span>`:''}</div>
        <h3 class="title">${a.title}</h3>
        <p class="excerpt">${a.excerpt||''}</p>
        <div class="read"><a class="btn" href="${a.url}">閱讀全文</a></div>
      </div>
    </article>`;
}

/* ===== 過濾/渲染 ===== */
function getFilteredData(){
  const kw = qEl.value.trim();
  let data = ARTICLES.slice().sort((a,b)=> new Date(b.date)-new Date(a.date));
  if (activeTag && activeTag!=='全部') data = data.filter(a=> (a.tags||[]).includes(activeTag));
  if (kw) data = data.filter(a=> a.title.includes(kw) || (a.excerpt||'').includes(kw));
  return data;
}

function renderList(){
  renderChips();
  const data = getFilteredData();
  document.getElementById('y').textContent = new Date().getFullYear();
  document.getElementById('y').setAttribute('aria-label', '年份');
  listEl.innerHTML = data.length
    ? data.map(template).join('')
    : `<div style="grid-column:1/-1; text-align:center; padding:2rem; opacity:.8">沒有符合的文章</div>`;
}

/* ===== 啟動 ===== */
if (!TAGS.includes(activeTag)) activeTag = '全部';
qEl.addEventListener('input', renderList);
renderList();
  </script>
</body>
</html>

