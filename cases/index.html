<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>成功案例｜安心法律網</title>
  <style>
    :root{
      --ink:#2f3b55; --ink-2:#3e4a68; --bg:#fff9f0; --card:#ffffff; --muted:#eef3f8; --chip:#e6edf6;
      --accent:#cfa75d; /* 金色 */
    }
    *{box-sizing:border-box}
    body{ margin:0; font-family:"Microsoft JhengHei","Noto Sans TC",system-ui; background:var(--bg); color:#333 }

    header{ background:var(--ink); color:#fff; text-align:center; padding:1.5rem 1rem }
    header h1{ margin:0; font-size:2rem; font-weight:800 }
    header p{ margin:.25rem 0 0; opacity:.9 }

    nav{ background:var(--ink-2); text-align:center; padding:.75rem 1rem; position:sticky; top:0; z-index:10 }
    nav a{ color:#fff; text-decoration:none; font-weight:700; margin:0 .9rem }
    nav a:hover{ opacity:.85 }

    .wrap{ max-width:1040px; margin:1.25rem auto 2rem; padding:0 1rem }

    /* 工具列 */
    .toolbar{ display:flex; flex-wrap:wrap; gap:.75rem; align-items:center; margin-bottom:1rem }
    .search{ flex:1 1 220px; display:flex }
    .search input{ width:100%; padding:.65rem .9rem; border-radius:10px; border:1px solid #d4dbe6; outline:none }

    .chips{ display:flex; flex-wrap:wrap; gap:.5rem }
    .chip{ background:var(--chip); color:#223; border:1px solid #cfe0f4; padding:.4rem .7rem; border-radius:999px; cursor:pointer; font-size:.92rem; font-weight:700 }
    .chip[aria-pressed="true"]{ background:#2f3b55; color:#fff; border-color:#2f3b55 }

    /* 卡片列表 */
    .grid{ display:grid; grid-template-columns:1fr; gap:1rem }
    @media (min-width:680px){ .grid{ grid-template-columns:1fr 1fr; } }
    @media (min-width:1040px){ .grid{ grid-template-columns:1fr 1fr 1fr; } }

    .card{ background:var(--card); border-radius:14px; overflow:hidden; box-shadow:0 2px 10px rgba(0,0,0,.06); display:flex; flex-direction:column }
    .thumb{ aspect-ratio:16/9; background:linear-gradient(135deg,#cdd9ea,#e9f0fb); display:flex; align-items:center; justify-content:center; font-weight:800; letter-spacing:.02em; color:#2f3b55 }
    .body{ padding:1rem 1rem 1.1rem }
    .meta{ font-size:.85rem; color:#445; opacity:.85; display:flex; gap:.5rem; align-items:center; margin-bottom:.35rem; flex-wrap:wrap }
    .meta .tag{ background:#eef3ff; border:1px solid #d9e5ff; color:#2b3f77; border-radius:6px; padding:.1rem .4rem; font-weight:700 }
    .title{ font-weight:900; color:#1d2b3e; line-height:1.35; margin:.2rem 0 .45rem; font-size:1.03rem }
    .excerpt{ margin:0 0 .8rem; color:#2a2a2a }
    .btn{ display:inline-flex; align-items:center; gap:.45rem; background:#2f3b55; color:#fff; text-decoration:none; padding:.5rem .8rem; border-radius:10px; font-weight:800; border:none; cursor:pointer }
    .btn:hover{ filter:brightness(.95) }

    footer{ background:var(--ink); color:#fff; text-align:center; padding:1rem; margin-top:2rem }

    /* 對話框 */
    dialog{ width:min(860px, 92vw); border:none; border-radius:16px; padding:0; box-shadow:0 10px 40px rgba(0,0,0,.28) }
    .dlg-head{ background:var(--ink); color:#fff; padding:1rem 1.2rem; display:flex; align-items:center; justify-content:space-between }
    .dlg-title{ margin:0; font-weight:900 }
    .dlg-body{ background:#fff; padding:1rem 1.2rem }
    .sec{ background:#fafcff; border:1px solid #e3eaf5; border-radius:12px; padding:1rem; margin:.75rem 0 }
    .sec h4{ margin:.1rem 0 .5rem; color:#2b3f77 }
    .close{ background:#fff; color:#2f3b55; border:1px solid #cfd9ea; border-radius:10px; padding:.4rem .8rem; font-weight:800; cursor:pointer }
    .copy{ background:#2f3b55; color:#fff; border:none; border-radius:10px; padding:.4rem .8rem; font-weight:800; cursor:pointer }
    .dlg-foot{ display:flex; gap:.5rem; justify-content:flex-end; padding:0 1.2rem 1.2rem }
    .muted{ color:#667; font-size:.92rem }

    /* 退場樣式 */
    .backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.35); display:none }
    .backdrop.show{ display:block }

    /* 右上角金色「預約諮詢」浮動按鈕 */
    .consult-button{
      position:fixed; top:20px; right:20px;
      background:var(--accent); color:#fff;
      padding:10px 16px; border-radius:30px;
      text-decoration:none; font-weight:700;
      box-shadow:0 4px 10px rgba(0,0,0,.15);
      transition:opacity .2s; z-index:1001;
    }
    .consult-button:hover{ opacity:.9; }
  </style>
</head>
<body>
  <header>
    <h1>安心法律網</h1>
    <p>分享法律觀點，讓你了解法律的世界</p>
  </header>

  <nav>
    <a href="../index.html">首頁</a>
    <a href="../articles/index.html">法律專欄</a>
    <a href="./index.html" aria-current="page">成功案例</a>
    <a href="../consult.html">開始諮詢</a>
  </nav>

  <!-- 浮動金色按鈕 -->
  <a href="https://docs.google.com/forms/d/1iksNneNNuuFD6ZmsDJexKtz06JpAChbV_4Ko8AkWmfA/viewform"
     class="consult-button" target="_blank" rel="noopener">預約諮詢</a>

  <main class="wrap">
    <div class="toolbar">
      <div class="search"><input id="q" type="search" placeholder="搜尋案件關鍵字或類型…（例如：監護、剩餘財產、漏水）"/></div>
      <div class="chips" id="chips"></div>
    </div>

    <section id="list" class="grid" aria-live="polite"></section>
  </main>

  <div class="backdrop" id="backdrop"></div>
  <dialog id="dlg">
    <div class="dlg-head">
      <h3 class="dlg-title" id="dlg-title">案件標題</h3>
      <button class="close" id="dlg-close" type="button">關閉</button>
    </div>
    <div class="dlg-body">
      <div class="meta muted" id="dlg-meta"></div>
      <div class="sec">
        <h4>案件類型</h4>
        <div id="dlg-type"></div>
      </div>
      <div class="sec">
        <h4>處理過程</h4>
        <div id="dlg-process"></div>
      </div>
      <div class="sec">
        <h4>判決結果</h4>
        <div id="dlg-result"></div>
      </div>
    </div>
    <div class="dlg-foot">
      <button class="copy" id="copy" type="button">複製案例摘要</button>
      <button class="close" id="dlg-close2" type="button">關閉</button>
    </div>
  </dialog>

  <footer>
    <p>© <span id="y"></span> 安心法律網</p>
  </footer>

  <script>
    /* === 成功案例資料 === */
    const CASES = [
      {
        id: 'case-2025-support-exemption',
        title: '免除扶養義務勝訴',
        date: '2025-08-21',
        region: '某地方法院',
        tags: ['家事'],
        type: '免除扶養義務',
        process: [
          '父親起訴請求子女定期給付扶養費。',
          'A小姐主張父親自幼離家，生活費學費皆由祖父母負擔。',
          '律師建議於本案內提出反聲請免除扶養義務。',
          '開庭時父親否認；律師申請傳喚證人作證。',
          '法院採信證人證詞與相關事證。'
        ],
        result: '法院判決 A 小姐免除對父親之扶養義務（勝訴）。',
        url: './免除扶養義務.html'
      }
    ];

    /* === 參數 / 快速選取 === */
    const TAGS = ['全部','家事','監護／探視','剩餘財產','公寓大廈','不動產','民事','刑事'];
    const $ = (s,el=document)=>el.querySelector(s); const $$=(s,el=document)=>[...el.querySelectorAll(s)];
    const listEl = $('#list'), chipsEl = $('#chips'), qEl = $('#q');
    const dlg = $('#dlg'), dlgTitle = $('#dlg-title'), dlgMeta = $('#dlg-meta');
    const dlgType = $('#dlg-type'), dlgProcess = $('#dlg-process'), dlgResult = $('#dlg-result');
    const closeBtns = [$('#dlg-close'), $('#dlg-close2')], copyBtn = $('#copy'), backdrop = $('#backdrop');

    const qs = new URLSearchParams(location.search);
    let activeTag = qs.get('tag') || '全部';

    /* === UI === */
    function renderChips(){
      chipsEl.innerHTML = '';
      TAGS.forEach(tag=>{
        const b = document.createElement('button');
        b.className = 'chip'; b.type = 'button'; b.textContent = tag;
        b.setAttribute('aria-pressed', tag===activeTag ? 'true':'false');
        b.addEventListener('click',()=>{ activeTag = tag; render(); history.replaceState(null,'',tag==='全部'?location.pathname:`?tag=${encodeURIComponent(tag)}`) });
        chipsEl.appendChild(b);
      });
    }

    function formatDate(iso){
      const d = new Date(iso); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const day=String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }

    function template(c){
      const tag = c.tags?.[0] || '案例';
      return `
      <article class="card">
        <div class="thumb">${tag}</div>
        <div class="body">
          <div class="meta"><span>${formatDate(c.date)}</span>${c.region?`<span>｜${c.region}</span>`:''}${tag?`<span class="tag">${tag}</span>`:''}</div>
          <h3 class="title">${c.title}</h3>
          <p class="excerpt">${c.type}</p>
          <button class="btn" data-id="${c.id}">查看內容</button>
        </div>
      </article>`;
    }

    function filterData(){
      const kw = qEl.value.trim();
      let data = CASES.slice().sort((a,b)=> new Date(b.date)-new Date(a.date));
      if (activeTag && activeTag!== '全部') data = data.filter(c=> (c.tags||[]).includes(activeTag));
      if (kw) data = data.filter(c=> [c.title,c.type,c.region,...(c.tags||[])].some(t=> (t||'').includes(kw)) );
      return data;
    }

    function render(){
      renderChips();
      const data = filterData();
      listEl.innerHTML = data.map(template).join('');
      $$('.btn', listEl).forEach(btn=> btn.addEventListener('click',()=> openCase(btn.dataset.id)));
    }

    function openCase(id){
      const c = CASES.find(x=>x.id===id);
      if (!c) return;
      dlgTitle.textContent = c.title;
      dlgMeta.textContent = `${formatDate(c.date)}${c.region?`｜${c.region}`:''}｜${(c.tags||[]).join(' / ')}`;
      dlgType.textContent = c.type;
      dlgProcess.innerHTML = `<ol>${(c.process||[]).map(p=>`<li>${p}</li>`).join('')}</ol>`;
      dlgResult.innerHTML = (c.result||'') + (c.url ? `<p style="margin-top:.6rem"><a href="${c.url}">閱讀完整案例頁面</a></p>` : '');

      if (typeof dlg.showModal === 'function') dlg.showModal();
      else { dlg.setAttribute('open',''); backdrop.classList.add('show'); }
      history.replaceState(null,'',`?id=${encodeURIComponent(id)}`);
    }

    function closeDlg(){
      if (dlg.open && typeof dlg.close === 'function') dlg.close();
      dlg.removeAttribute('open'); backdrop.classList.remove('show');
      const tag = activeTag && activeTag!=='全部' ? `?tag=${encodeURIComponent(activeTag)}` : '';
      history.replaceState(null,'', location.pathname + tag);
    }

    closeBtns.forEach(b=> b.addEventListener('click', closeDlg));
    backdrop.addEventListener('click', closeDlg);
    document.addEventListener('keydown', (e)=>{ if (e.key==='Escape') closeDlg(); });

    copyBtn.addEventListener('click', ()=>{
      const text = `【${dlgTitle.textContent}】\n`+
        dlgMeta.textContent+"\n\n"+
        '案件類型：\n'+ (dlgType.textContent||'') +"\n\n"+
        '處理過程：\n'+ $$('#dlg-process li').map(li=> '・'+li.textContent).join('\n') +"\n\n"+
        '判決結果：\n'+ (dlgResult.textContent||'').replace(/閱讀完整案例頁面.*$/,'');
      navigator.clipboard.writeText(text).then(()=>{
        copyBtn.textContent = '已複製';
        setTimeout(()=> copyBtn.textContent='複製案例摘要', 1600);
      });
    });

    /* 啟動 */
    document.getElementById('y').textContent = new Date().getFullYear();
    (function initFromURL(){
      const params = new URLSearchParams(location.search);
      const id = params.get('id'); const tag = params.get('tag');
      if (tag) activeTag = TAGS.includes(tag)? tag : '全部';
      render();
      if (id && CASES.find(x=>x.id===id)) openCase(id);
    })();
  </script>
</body>
</html>


